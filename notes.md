> 《ORANGE's: 一个操作系统的实现》读书笔记
> 书籍百度云盘地址:
> 代码存放位置: 

### 基本概念
* GNU/Linux与Linux
    * 实际上Linux并不是一个操作系统，而只是操作系统的内核，GNU/Linux才是操作系统.在之前的文章中(《鸟哥私房菜》某个章节)谈到过，操作系统包括内核和系统调用开发接口，而GNU就包含了大量的系统调用接口，代码量是内核的十倍左右.
* 例程
    * 例程的作用类似于函数，但含义更为丰富一些.例程是某个系统对外提供的功能接口或服务的集合.比如操作系统的API、服务等就是例程；Delphi或C++Builder提供的标准函数和库函数等也是例程.
* 重要数字
    * `0xaa55`: 如果软盘的0面0磁道1扇区，发现以0xaa55结束，则BIOS就会认为它是一个引导扇区.
    * `0000:7c00`: 一旦BIOS发现了引导扇区，就会将引导扇区512字节的内容装载到内存地址0000:7c00处，并跳转到此处将控制权交给这段代码.
* NASM与MASM
    * 在NASM中，任何不被`[]`的标签或变量名都认为是地址，访问标签中内容必须加`[]`.可以说变量和标签一样:`foo dw 1 等价于 foo: dw 1`.
    * 在NASM中，`$`表示当前行被编译后的地址，`$$`表示一个节(section)的开始处被编译后的地址.

### 常用工具
* nasm自带反编译工具`ndisasm`
    * -o 自定起始地址
* 虚拟机`bochs`
    * 安装过程会遇到各种各样的问题，但是确实可以安装成功
    * 安装及使用过程遇到问题可参考:http://www.cnblogs.com/JohnShao/archive/2011/10/23/2221565.html
    * 调试命令![1](https://cloud.githubusercontent.com/assets/16068384/21171210/3556b8c0-c205-11e6-84b5-3d4f982864c7.png)
    * 生成软盘映像: 直接运行`bximage`

### 保护模式
* 推荐一篇文章，这个讲的十分详细<a href="http://www.techbulo.com/708.html"><font color="blue">http://www.techbulo.com/708.html</font></a>
* Intel8086是16位的CPU，它有着16位的寄存器、16位的数据总线以及20位的地址总线(1M的寻址能力:`段:偏移量`)；从80386开始，intel的cpu进入了32位时代，80386有32位地址(4GB的寻址能力)
* 现阶段实模式就是8086模式，而保护模式下“段”的概念发生了变化，虽然段值仍然由原来的16位cs、ds等寄存器表示，但是段变成了一个索引，指向数据结构中的一个表项，在表项中详细定义了段的起始地址、界限、属性等内容.这个数据结构被称为<b>GDT或LDT</b>.GDT的表项被成为描述符Descriptor.<b>GDT的作用是提供段式存储结构，通过段存储器和GDT中的描述符共同提供</b>
* 代码段和数据段描述符![1](https://cloud.githubusercontent.com/assets/16068384/21181709/2bd2a3a6-c23a-11e6-8ca4-c270c3ef0759.png)
* 选择子: 描述符相对于GDT基址的偏移，但是更加复杂一些(携带T1和RPL).寄存器和段的对应关系是通过选择子实现的(实模式下段寄存器).![1](https://cloud.githubusercontent.com/assets/16068384/21181932/4b4c6af4-c23b-11e6-868b-1bdfc4a998b4.png)
* 段式寻址示意图![1](https://cloud.githubusercontent.com/assets/16068384/21182214/ddd023ec-c23c-11e6-969b-2e250f0bb766.png)
